
### C - 渡尘

> 给定长度为 $n$ 的序列 $a$，给定 $m$ 次询问。
>
> 每次询问询问区间 $[l, r]$ 的最大子段贡献，一个子段的贡献是它的所有元素之和的最大值。
>
> $n \le 2e5, m \le 3e6$，$1s$。

首先不难想到一个简单的 $O((n + m) \log n)$ 的做法，就是仿照 GSS1 ，直接维护每个区间的最大最小子段和，最后取 Abs 之后再取 Max 即可。（考试的时候因为做过 GSS1 导致思维定式了 /ll，应该多想想的）

这个做法能拿到 $70pts$，瓶颈在于单次 $\log n$ 的询问，因为这个是不带修的，所以用线段树做显然浪费了。

所以考虑一个能够 $O(1)$ 回答的做法，可以直接猫树，但是我不会。

所以考虑找找性质，发现最大子段和的绝对值实际上就是找到 $[l, r]$ 当中最大的 $pre[y] - pre[x - 1]$，所以我们直接维护区间里所有位置的 $pre$ （前缀和）的最大最小值即可。

然后还有一种做法就是直接 ST 表维护，因为上面转化了之后这个问题本质上就是 RMQ 了。

所以其实还可以 Four Russian $O(n + m)$ 做（

代码略。

### D - 罪⼈挽歌

> 求是否存在⼀个⼆元组 $\{A, B\}$ 的排列，使得这些⼆元组满⾜对于任意 $i \in [1, n)$ ，有 $A_i = A_{i + 1}$ 或 $B_i = B_{i + 1}$ 。
>
> 且对于任意 $i \in [2, n)$，$A_{i - 1} = A_i = A_{i + 1}$ 和 $B_{i - 1} = B_i = B_{i + 1}$ 都不成⽴。
>
> 如果有解，你还需要找到字典序最⼩的解。我们认为⼀个⼆元组的字典序更⼩，当且仅当这个⼆元组在输⼊中更早出现。
>
> $1 \le n \le 5e5$，不存在完全一样的二元组。

感觉应该是 $O(n)$ 的算法。

直接嗯搞好像看不出什么性质。

观察一下这两个限制条件构造出来的合法解会是什么样子：

如果 $A_i = A_{i + 1}$，那么 $B_{i + 1} = B_{i + 2}$。

也就是前一个如果是 $A$ 相等，后一个就必须是 $B$ 相等。

类似某一场 ABC 的 Card 一题，把一个二元组看做一条边（$u -v$）：

直接在 $1 \sim n$ 这上面考虑不好看，所以拆点，问题就变成了一个二分图。

那么两个限制条件就会变成：在排列上挨着的两条边必须共用一条边，相邻的三条边不能同时共用一个节点，那么就是这样的形状：

[![xWQR1g.png](https://s1.ax1x.com/2022/10/26/xWQR1g.png)](https://imgse.com/i/xWQR1g)

可以发现这个东西本质上就是在求一条欧拉路径，如果不存在欧拉路径则无解。

于是我们直接对于欧拉图跑回路，或者直接对于半欧拉图，把多出来的两个点连起来跑回路即可。

但是这并不能保证字典序最小。
