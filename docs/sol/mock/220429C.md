## C组模拟赛部分题解

> Apr 29th 2022

### T4 线索

原题 [TJOI2015]概率论。

> 对于 $n$ 个节点的有根二叉树的所有形态，
>
> 假设每一种形态的出现概率相同，求叶子节点个数的期望。
>
> 原题有理数不取模，误差 $10^{-9}$ 即可，本题要取模。
>
> $1\le n \le 10^9$。

首先一个显然的结论就是，$n$ 个节点的有根二叉树的形态个数是 $f_n = \dfrac{2\times\text{C}^{n}_{2n}}{n + 1}$。

也就是卡特兰数。

所以我们只需要求出 $n$ 个节点的有根二叉树的形态数 $g_n$ 即可，那么期望值 $E(n) = \dfrac{g_n}{f_n}$。

打表可以发现：

| $n$   | 1    | 2    | 3    | 4    | 5    |
| ----- | ---- | ---- | ---- | ---- | ---- |
| $f_n$ | 1    | 2    | 5    | 14   | 42   |
| $g_n$ | 1    | 2    | 6    | 20   | 70   |

$g_n = n \times f_{n-1}$。

怎么具体证明呢？

搬了 @_rqy 姐姐的证明：

- 对于每棵 $n$ 个点的二叉树，如果里面有 $k$ 个叶节点，那么我们分别把这 $k$ 个叶子删去会得到 $k$ 棵 $n-1$ 个点的二叉树；
- 而每棵 $n-1$ 个点的二叉树恰好有 $n$ 个位置可以悬挂一个新的叶子，所以每棵 $n-1$ 个点的二叉树被得到了 $n$ 次；
- 综上，我们即可得出结论：所有 $n$ 个点的二叉树的叶子个数和等于 $n-1$ 个点的二叉树个数 $\times n$。

化简式子可以得到：

$$ans = \dfrac{n(n+1)}{2(2n-1)}$$

```cpp
Tag : 数学/数论/卡特兰/二叉树/递推式
```